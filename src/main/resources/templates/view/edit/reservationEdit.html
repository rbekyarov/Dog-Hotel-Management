<th:block th:unless="${session.isEmpty()}">
    <th:block th:fragment xmlns:th="http://www.w3.org/1999/xhtml">
        <div class="button_back">
            <a class="nav-link h5" th:href="@{/view/table/reservationTable}">
                <button type="button" class="btn btn-danger btn-lg btnTable"><span
                        class="glyphicon glyphicon-ok"></span>Back
                </button>
            </a>
        </div>
        <div class="container">
            <h2 class="page_title">Edit Reservation</h2>

            <form class="form_add"  th:action="@{{id}/edit(id=*{id})}"
                  th:method="post"
                  th:object="${reservationDTO}">

                <div class="form-group">
                    <label class="text-white font-weight-bold"></label>

                    <table align="center" border="0" cellpadding="1" cellspacing="1" style="width:auto">
                        <tbody>
                        <tr>
                            <td> <label>Client:</label><br>
                                <select required id="showClient" name="showClient" th:field="*{client.id}" oninput="getClientDogs()">

                                    <option value="">Please select</option>
                                    <option
                                            th:each="showClient : ${allClients}"
                                            th:value="${showClient.id}"
                                            th:text="${showClient.email}"
                                    ></option>
                                </select><br></td>
                        </tr>
                        <tr>
                            <td><label>Dogs:</label><br>
                                <select id="dogsBox" th:field="*{dog.id}" onclick="getCells()">
                                    <option
                                            th:each="dog : *{dog}"
                                            th:value="${dog.id}"
                                            th:text="${dog.name}"
                                    ></option>
                                </select><br></td>
                        </tr>
                        <tr>
                            <td> <label>Date of Arrival:</label><br>
                                <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                                    <input required type="text" class="form-control datetimepicker-input"
                                           data-target="#datetimepicker1"
                                           th:field="*{startDate}" id="date" placeholder="Date"/>
                                    <div class="input-group-append" data-target="#datetimepicker1"
                                         data-toggle="datetimepicker">
                                        <div class="input-group-text"><i class="fa fa-calendar-alt"></i></div>
                                    </div>
                                </div></td>
                        </tr>
                        <tr>
                            <td> <label>Date of Departure:</label><br>
                                <div class="input-group date" id="datetimepicker2" data-target-input="nearest">
                                    <input required type="text" class="form-control datetimepicker-input"
                                           data-target="#datetimepicker2"
                                           th:field="*{endDate}" id="date2" placeholder="Date"/>
                                    <div class="input-group-append" data-target="#datetimepicker2"
                                         data-toggle="datetimepicker">
                                        <div class="input-group-text"><i class="fa fa-calendar-alt"></i></div>
                                    </div>
                                </div></td>
                        </tr>
                        <tr>
                            <td><label>Dog House:</label><br>
                                <select required id="cellsBox" th:field="*{cell}">
                                    <option value="">Please select</option>
                                    <option
                                            th:each="cellsBox : ${allEmptyCells}"
                                            th:value="${cellsBox.id}"
                                            th:text="${cellsBox.code}"></option>

                                </select><br><br></td>
                        </tr>
                        </tbody>
                    </table>

                    <table align="center" border="0" cellpadding="1" cellspacing="1" style="width: auto">
                        <tbody>
                        <tr>
                            <td><label th:text="${'Feeding: '+ price.getPriceFood()+'$'}"></label><br>
                                <select th:field="*{food}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                            <td><label th:text="${'Deworming: '+ price.getPriceDeworming()+'$'}"></label><br>
                                <select th:field="*{deworming}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>

                        </tr>
                        <tr>
                            <td><label th:text="${'Training: price '+ price.getPriceTraining()+'$'}"></label><br>
                                <select th:field="*{training}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                            <td><label th:text="${'Bathing: price '+ price.getPriceBathing()+'$'}"></label><br>
                                <select th:field="*{bathing}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>

                        </tr>
                        <tr>
                            <td><label th:text="${'Ð•ar cleaning: price '+ price.getPriceEars()+'$'}"></label><br>
                                <select th:field="*{ears}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                            <td><label th:text="${'Paws cleaning: price '+ price.getPricePaws()+'$'}"></label><br>
                                <select th:field="*{paws}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                        </tr>
                        <tr>
                            <td><label th:text="${'Nails trimming: price '+ price.getPriceNails()+'$'}"></label><br>
                                <select th:field="*{nails}"><br>
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                            <td><label th:text="${'Combing: price '+ price.getPriceCombing()+'$'}"></label><br>
                                <select th:field="*{combing}">
                                    <option value="NO">NO</option>
                                    <option value="YES">YES</option>
                                </select><br></td>
                        </tr>
                        </tbody>
                    </table>


                    <label>Discount %</label><br>
                    <input type="text" id="description22" th:field="*{discount}"
                           placeholder="Max Discount 20%"/><br>
                </div>
                <div class="button_submit">
                    <div>
                        <div>
                            <input type="submit" class="btn btn-danger btn-lg btnTable " value="Edit Reservation"/>
                        </div>
                    </div>
                </div>
            </form>
        </div>


        <script th:src="@{/assets/moment/moment.min.js}"></script>
        <script th:src="@{/assets/tempusdominus-bootstrap-4/tempusdominus-bootstrap-4.min.js}"></script>
        <script>
            $.fn.datetimepicker.Constructor.Default = $.extend({}, $.fn.datetimepicker.Constructor.Default, {
                icons: {
                    time: 'far fa-clock',
                    date: 'far fa-calendar',
                    up: 'fas fa-arrow-up',
                    down: 'fas fa-arrow-down',
                    previous: 'fas fa-chevron-left',
                    next: 'fas fa-chevron-right',
                    today: 'far fa-calendar-check-o',
                    clear: 'far fa-trash',
                    close: 'far fa-times'
                }
            });

            $('#datetimepicker1').datetimepicker({
                format: 'DD/MM/YYYY'
            });

        </script>
        <script>
            $.fn.datetimepicker.Constructor.Default = $.extend({}, $.fn.datetimepicker.Constructor.Default, {
                icons: {
                    time: 'far fa-clock',
                    date: 'far fa-calendar',
                    up: 'fas fa-arrow-up',
                    down: 'fas fa-arrow-down',
                    previous: 'fas fa-chevron-left',
                    next: 'fas fa-chevron-right',
                    today: 'far fa-calendar-check-o',
                    clear: 'far fa-trash',
                    close: 'far fa-times'
                } });

            $('#datetimepicker2').datetimepicker({
                format: 'DD/MM/YYYY'
            });
        </script>
        <script th:inline="javascript">
            /*<![CDATA[*/

            var clientList = /*[[${allClients}]]*/ 'test';
            /*]]>*/
        </script>

        <script>

            function getClientDogs() {
                const clientId = Number(document.getElementById('showClient').value);
                let length = clientList.length
                for (let i = 0; i < length; i++) {
                    if (clientList[i].id === clientId) {
                        $('#dogsBox option').remove();
                        const dogs = clientList[i].dogs;
                        for (let n = 0; n < dogs.length; n++) {
                            $('#dogsBox').append($('<option>', {
                                value: dogs[n].id,
                                text: dogs[n].name
                            }));
                        }
                        $("#dogsBox").trigger("chosen:updated");
                    }
                }
            }
        </script>
        <script>
            function getCells() {

                const dogId = Number(document.getElementById('dogsBox').value);
                const clientId = Number(document.getElementById('showClient').value);
                let length = dogList.length
                for (let i = 0; i < length; i++) {
                    let client = clientList[i];
                    if(client.id===clientId){
                        let dogs = clientList[i].dogs
                        for (let j = 0; j < dogs.length; j++) {
                            if(dogs[j].id==dogId){
                                let dog = dogs[j];
                                dogSize = dog.dogSize;
                                $('#cellsBox option').remove();
                                if (dogSize === 'SMALL') {
                                    for (let j = 0; j < cellList.length; j++) {
                                        if (cellList[j].cellSize === "SMALL") {
                                            $('#cellsBox').append($('<option>', {
                                                value: cellList[j].id,
                                                text: cellList[j].code+' '+cellList[j].cellSize
                                            }));
                                        }
                                    }
                                } else if (dogSize === 'MEDIUM') {
                                    for (let j = 0; j < cellList.length; j++) {
                                        if (cellList[j].cellSize === "MEDIUM") {
                                            $('#cellsBox').append($('<option>', {
                                                value: cellList[j].id,
                                                text: cellList[j].code+' '+cellList[j].cellSize
                                            }));
                                        }
                                    }
                                } else if (dogSize === 'LARGE') {
                                    for (let j = 0; j < cellList.length; j++) {
                                        if (cellList[j].cellSize === "LARGE") {
                                            $('#cellsBox').append($('<option>', {
                                                value: cellList[j].id,
                                                text: cellList[j].code+' '+cellList[j].cellSize
                                            }));
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        </script>
    </th:block>
</th:block>
